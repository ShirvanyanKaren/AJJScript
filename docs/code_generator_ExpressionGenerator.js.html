<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: code_generator/ExpressionGenerator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: code_generator/ExpressionGenerator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * ExpressionGenerator.js
 *
 * Handles expression code generation for AJJScript.
 */

function generateExpression(expr, ctx) {
    if (!expr) return "";
  
    const { generateExpression: gen, currentClass, declaredVariables } = ctx;
  
    switch (expr.type) {
      case "BinaryExpression": {
        const left = gen(expr.left, ctx);
        const right = gen(expr.right, ctx);
        const op = translateOperator(expr.operator);
        return `(${left} ${op} ${right})`;
      }
      case "Variable": {
        const name = expr.name;
        if (expr.isParam) return name;
        if (currentClass &amp;&amp; !declaredVariables.has(name)) return `this.${name}`;
        return name;
      }
      case "IntegerLiteral":
        return expr.value.toString();
      case "StringLiteral":
        return `\"${expr.value}\"`;
      case "BooleanLiteral":
        return expr.value.toString();
      case "This":
        return "this";
      case "CallExpression":
        case "MethodCall": {
          const args = expr.args.map(arg => gen(arg, ctx)).join(", ");      
          if (expr.callee === "Global") {
            return `${expr.methodName}(${args})`;
          }
          const callee = gen(expr.callee, ctx);
          return `${callee}.${expr.methodName}(${args})`;
        }
        
      case "NewExpression": {
        const args = expr.args.map(arg => gen(arg, ctx)).join(", ");
        return `new ${expr.className}(${args})`;
      }
      case "FieldAccess": {
        const object = gen(expr.object, ctx);
        return `${object}.${expr.field}`;
      }
      case "TernaryExpression": {
        const cond = gen(expr.condition, ctx);
        const trueExpr = gen(expr.trueExpr, ctx);
        const falseExpr = gen(expr.falseExpr, ctx);
        return `(${cond} ? ${trueExpr} : ${falseExpr})`;
      }
      case "PostfixIncrement":
        return `${gen(expr.operand, ctx)}++`;
      case "PrefixIncrement":
        return `++${gen(expr.operand, ctx)}`;
      case "Print":
        return `AJJ.print(${gen(expr.argument, ctx)})`;
      default:
        return "/* unknown expression */";
    }
  }
  
  function translateOperator(op) {
    const operatorMap = {
      PlusToken: "+",
      MinusToken: "-",
      MultiplyToken: "*",
      DivideToken: "/",
      AssignmentToken: "=",
    };
  
    if (!op) return "+";
    if (typeof op === "string") return op;
    if (op.constructor?.name &amp;&amp; operatorMap[op.constructor.name]) {
      return operatorMap[op.constructor.name];
    }
    return "+";
  }
  
  module.exports = { generateExpression };
  </code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="global.html#CodeGenerator">CodeGenerator</a></li><li><a href="Parser.html">Parser</a></li><li><a href="Tokenizer.html">Tokenizer</a></li><li><a href="TypeChecker.html">TypeChecker</a></li></ul><h3>Global</h3><ul><li><a href="global.html#compileAndRun">compileAndRun</a></li><li><a href="global.html#generateClassDef">generateClassDef</a></li><li><a href="global.html#generateCode">generateCode</a></li><li><a href="global.html#generateExpression">generateExpression</a></li><li><a href="global.html#generateStatement">generateStatement</a></li><li><a href="global.html#parseClassDef">parseClassDef</a></li><li><a href="global.html#parseConstructor">parseConstructor</a></li><li><a href="global.html#parseMethodDef">parseMethodDef</a></li><li><a href="global.html#parseVarDec">parseVarDec</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun May 18 2025 21:18:27 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
